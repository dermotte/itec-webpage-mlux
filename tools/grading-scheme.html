<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notenschema-Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .card {
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            border: 1px solid rgba(0, 0, 0, 0.125);
        }
        .grade-header {
            background-color: #0d6efd;
            color: white;
            border-radius: 5px 5px 0 0;
        }
        .grade-table th {
            background-color: #e9ecef;
        }
        .form-control:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }
        .btn-primary {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }
        .btn-primary:hover {
            background-color: #0b5ed7;
            border-color: #0a58ca;
        }
        .result-container {
            background-color: white;
            border-radius: 5px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }
        .grade-cell {
            text-align: center;
            font-weight: bold;
        }
        .explanation {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 10px;
        }
        .copy-container {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .copy-btn {
            background-color: #28a745;
            border-color: #28a745;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .copy-btn:hover {
            background-color: #218838;
            border-color: #1e7e34;
        }
        .copy-message {
            margin-top: 10px;
            font-weight: bold;
            color: #28a745;
            display: none;
        }
        .copy-message.success {
            display: block;
        }
        .copy-message.error {
            color: #dc3545;
            display: block;
        }
        #htmlOutput {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header grade-header text-center">
                        <h2>Notenschema-Generator</h2>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="maxPoints" class="form-label">Maximale Punktzahl</label>
                            <input type="number" class="form-control" id="maxPoints" min="1" value="100">
                            <div class="form-text">Geben Sie die maximale Punktzahl ein, für die das Bewertungsschema erstellt werden soll.</div>
                        </div>
                        <button id="generateBtn" class="btn btn-primary w-100">Bewertungsschema erstellen</button>
                        
                        <div id="resultContainer" class="result-container d-none">
                            <h4 class="text-center">Bewertungsschema</h4>
                            <div class="table-responsive">
                                <table class="table table-bordered grade-table">
                                    <thead>
                                        <tr>
                                            <th>Punkte</th>
                                            <th>Noten</th>
                                            <th>Bewertung</th>
                                        </tr>
                                    </thead>
                                    <tbody id="gradeTableBody">
                                        <!-- Grades will be inserted here -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="copy-container">
                                <h5>Kopieren Sie das Schema</h5>
                                <p>Kopieren Sie das Bewertungsschema in verschiedenen Format:</p>
                                <div class="d-flex flex-wrap">
                                    <button id="copyHtmlBtn" class="btn copy-btn me-2 mb-2">HTML kopieren</button>
                                    <button id="copyMarkdownBtn" class="btn copy-btn me-2 mb-2">Markdown kopieren</button>
                                    <button id="copyTextBtn" class="btn copy-btn me-2 mb-2">Als Text kopieren</button>
                                    <div id="copyMessage" class="copy-message"></div>
                                </div>
                                <div id="htmlOutput"></div>
                            </div>
                            
                            <div class="explanation">
                                <p><strong>Erklärung:</strong></p>
                                <ul>
                                    <li>Unterhalb der Hälfte der maximalen Punkte: Note 5 (Nicht Genügend)</li>
                                    <li>Ab der Hälfte der maximalen Punkte: Gleichmäßige Aufteilung auf die Note 4, 3, 2, 1</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const maxPointsInput = document.getElementById('maxPoints');
            const generateBtn = document.getElementById('generateBtn');
            const resultContainer = document.getElementById('resultContainer');
            const gradeTableBody = document.getElementById('gradeTableBody');
            const copyHtmlBtn = document.getElementById('copyHtmlBtn');
            const copyMarkdownBtn = document.getElementById('copyMarkdownBtn');
            const copyTextBtn = document.getElementById('copyTextBtn');
            const copyMessage = document.getElementById('copyMessage');
            const htmlOutput = document.getElementById('htmlOutput');
            
            // Generate grades on button click
            generateBtn.addEventListener('click', generateGrades);
            
            // Also generate on Enter key in input field
            maxPointsInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    generateGrades();
                }
            });
            
            // Copy to clipboard functionality
            copyHtmlBtn.addEventListener('click', () => copyToClipboard('html'));
            copyMarkdownBtn.addEventListener('click', () => copyToClipboard('markdown'));
            copyTextBtn.addEventListener('click', () => copyToClipboard('text'));
            
            // Initial generation
            generateGrades();
            
            function generateGrades() {
                const maxPoints = parseInt(maxPointsInput.value);
                
                if (isNaN(maxPoints) || maxPoints <= 0) {
                    alert('Bitte geben Sie eine gültige positive Zahl ein.');
                    return;
                }
                
                // Clear previous results
                gradeTableBody.innerHTML = '';
                
                // Calculate the threshold for passing grades
                const halfPoints = Math.floor(maxPoints / 2);
                
                // Calculate grade boundaries correctly
                const grade4Boundary = halfPoints + Math.floor((maxPoints - halfPoints) / 4);
                const grade3Boundary = halfPoints + Math.floor(2 * (maxPoints - halfPoints) / 4);
                const grade2Boundary = halfPoints + Math.floor(3 * (maxPoints - halfPoints) / 4);
                
                // Create grade rows
                const grades = [
                    { grade: 5, text: "Nicht Genügend", min: 0, max: halfPoints - 1 },
                    { grade: 4, text: "Genügend", min: halfPoints, max: grade4Boundary - 1 },
                    { grade: 3, text: "Befriedigend", min: grade4Boundary, max: grade3Boundary - 1 },
                    { grade: 2, text: "Gut", min: grade3Boundary, max: grade2Boundary - 1 },
                    { grade: 1, text: "Sehr Gut", min: grade2Boundary, max: maxPoints }
                ];
                
                // Create table rows
                grades.forEach(grade => {
                    const row = document.createElement('tr');
                    
                    // Points range
                    const pointsCell = document.createElement('td');
                    pointsCell.className = 'grade-cell';
                    if (grade.min === grade.max) {
                        pointsCell.textContent = `${grade.min}`;
                    } else {
                        pointsCell.textContent = `${grade.min} - ${grade.max}`;
                    }
                    row.appendChild(pointsCell);
                    
                    // Grade
                    const gradeCell = document.createElement('td');
                    gradeCell.className = 'grade-cell';
                    gradeCell.textContent = grade.grade;
                    row.appendChild(gradeCell);
                    
                    // Description
                    const descCell = document.createElement('td');
                    descCell.textContent = grade.text;
                    row.appendChild(descCell);
                    
                    gradeTableBody.appendChild(row);
                });
                
                // Generate HTML for copying
                generateHtmlOutput(grades, maxPoints);
                
                // Show result container
                resultContainer.classList.remove('d-none');
            }
            
            function generateHtmlOutput(grades, maxPoints) {
                let html = `<table class="table table-bordered grade-table">\n`;
                html += `  <thead>\n`;
                html += `    <tr>\n`;
                html += `      <th>Punkte</th>\n`;
                html += `      <th>Noten</th>\n`;
                html += `      <th>Bewertung</th>\n`;
                html += `    </tr>\n`;
                html += `  </thead>\n`;
                html += `  <tbody>\n`;
                
                grades.forEach(grade => {
                    html += `    <tr>\n`;
                    if (grade.min === grade.max) {
                        html += `      <td class="grade-cell">${grade.min}</td>\n`;
                    } else {
                        html += `      <td class="grade-cell">${grade.min} - ${grade.max}</td>\n`;
                    }
                    html += `      <td class="grade-cell">${grade.grade}</td>\n`;
                    html += `      <td>${grade.text}</td>\n`;
                    html += `    </tr>\n`;
                });
                
                html += `  </tbody>\n`;
                html += `</table>`;
                
                htmlOutput.textContent = html;
            }
            
            function copyToClipboard(format) {
                let content = '';
                
                if (format === 'html') {
                    content = htmlOutput.textContent;
                } else if (format === 'markdown') {
                    // Generate Markdown table
                    content = "| Punkte | Noten | Bewertung |\n|--------|-------|-----------|\n";
                    const maxPoints = parseInt(maxPointsInput.value);
                    const halfPoints = Math.floor(maxPoints / 2);
                    const grade4Boundary = halfPoints + Math.floor((maxPoints - halfPoints) / 4);
                    const grade3Boundary = halfPoints + Math.floor(2 * (maxPoints - halfPoints) / 4);
                    const grade2Boundary = halfPoints + Math.floor(3 * (maxPoints - halfPoints) / 4);
                    
                    content += `| 0 - ${halfPoints - 1} | 5 | Nicht Genügend |\n`;
                    content += `| ${halfPoints} - ${grade4Boundary - 1} | 4 | Genügend |\n`;
                    content += `| ${grade4Boundary} - ${grade3Boundary - 1} | 3 | Befriedigend |\n`;
                    content += `| ${grade3Boundary} - ${grade2Boundary - 1} | 2 | Gut |\n`;
                    content += `| ${grade2Boundary} - ${maxPoints} | 1 | Sehr Gut |\n`;
                } else {
                    // Generate plain text format
                    content = "Bewertungsschema\n";
                    content += "================\n\n";
                    content += "Punkte\t\tNoten\tBewertung\n";
                    content += "-------\t\t-----\t---------\n";
                    const maxPoints = parseInt(maxPointsInput.value);
                    const halfPoints = Math.floor(maxPoints / 2);
                    const grade4Boundary = halfPoints + Math.floor((maxPoints - halfPoints) / 4);
                    const grade3Boundary = halfPoints + Math.floor(2 * (maxPoints - halfPoints) / 4);
                    const grade2Boundary = halfPoints + Math.floor(3 * (maxPoints - halfPoints) / 4);
                    
                    content += `0 - ${halfPoints - 1}\t\t5\tNicht Genügend\n`;
                    content += `${halfPoints} - ${grade4Boundary - 1}\t\t4\tGenügend\n`;
                    content += `${grade4Boundary} - ${grade3Boundary - 1}\t\t3\tBefriedigend\n`;
                    content += `${grade3Boundary} - ${grade2Boundary - 1}\t\t2\tGut\n`;
                    content += `${grade2Boundary} - ${maxPoints}\t\t1\tSehr Gut\n`;
                }
                
                navigator.clipboard.writeText(content).then(() => {
                    // Show success message
                    copyMessage.textContent = 'In die Zwischenablage kopiert!';
                    copyMessage.className = 'copy-message success';
                    
                    // Hide message after 2 seconds
                    setTimeout(() => {
                        copyMessage.className = 'copy-message';
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                    copyMessage.textContent = 'Fehler beim Kopieren!';
                    copyMessage.className = 'copy-message error';
                });
            }
        });
    </script>
</body>
</html>